<!DOCTYPE html>

<html>

	<head>
		<title>Login</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="google-signin-scope" content="profile email">
		<meta name="google-signin-client_id" content="582207975118-11n2ri0d5m984j7a4d66oqvvujrp3o1m.apps.googleusercontent.com">

		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

		<!-- Custom Styles -->
		<link href="login_style.css" rel="stylesheet">

	</head>

	<body>

		<h1>Habit-at</h1>
		<div class="login-form">
			<form action="">
				<input id="input-username" type="text" title="username" autocomplete="username" placeholder="Username"/>
				<input id="input-password" type="password" title="username" autocomplete="off" placeholder="Password"/>
				<p id="login-alert" class="text-warning d-none"><b>Incorrect username or password!</b></p>
				<button id="submit-button" type="submit" class="btn login-btn">Login</button>
                <br>
				<!-- Google Sign-In -->

				<div class="g-signin2 btn" data-onsuccess="onSignIn"></div>
			</form>
			<form action="signup.html">
				<p>Don't have an account?</p>
				<button type="submit" class="btn signup-btn">Sign Up</button>
			</form>
		</div>




		<!-- JavaScript -->

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>

		<script type="text/JavaScript">
			$(document).ready(() => {

				// When Submit Button is clicked make AJAX request
				$('#submit-button').click(() => {
					// $('#login-alert').addClass('d-none');
					console.log('Making AJAX request to: ', 'login');
					$.ajax({
						url: 'login',
						type: 'POST',
						data: {
										username: $('#input-username').val(),
										password: $('#input-password').val()
						},
						success: (data) => {
							console.log('Signed In', data);
							console.log('userid', data.userid);
							window.localStorage.setItem('userid', data.userid);
							location.href = "accounts.html";
						},
					});
				});

				$(document).ajaxError(() => {
						console.log('AJAX ERROR');
						$('#login-alert').removeClass('d-none');
			  });
			});

		</script>

		<!-- Google Sign-In API -->
		<script>
      function onSignIn(googleUser) {
        // Useful data for your client-side scripts:
        var profile = googleUser.getBasicProfile();
        console.log("ID: " + profile.getId()); // Don't send this directly to your backend/server! Use ID token instead
        console.log('Name: ' + profile.getName());
        console.log("Image URL: " + profile.getImageUrl());
        console.log("Email: " + profile.getEmail()); // null if 'email' scope not present

        // The ID token you need to pass to your backend:
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("ID Token: " + id_token);
      };
    </script>



		<!-- Google Platform Library -->
		<script src="https://apis.google.com/js/platform.js" async defer></script>

	</body>
</html>
